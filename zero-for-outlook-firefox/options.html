<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Zero for Outlook – Settings</title>
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <main class="oz-container">
      <header class="oz-header">
        <div class="oz-icon-circle">
          <img
            src="icons/icon-48.png"
            alt="Zero for Outlook"
            width="32"
            height="32"
            style="border-radius: 8px;"
          />
        </div>
        <div>
          <h1>Zero for Outlook</h1>
          <p class="oz-subtitle">
            Customize keyboard shortcuts for Outlook on the web.
          </p>
        </div>
      </header>

      <section class="oz-card">
        <h2>Keyboard shortcuts</h2>
        <p class="oz-help">
          Click in a shortcut box, then press the key combination you want to use (for example
          <kbd>Ctrl</kbd> + <kbd>Z</kbd> or <kbd>Alt</kbd> + <kbd>U</kbd>).
        </p>

        <div class="oz-shortcut-group">
          <div class="oz-shortcut-row">
            <div class="oz-shortcut-info">
              <div class="oz-label">Undo archive</div>
              <p class="oz-help-sub">
                Trigger Outlook’s <em>Undo</em> after archiving or moving an email.
              </p>
            </div>
            <div class="oz-shortcut-controls">
              <label for="undoShortcut" class="oz-visually-hidden">Undo archive shortcut</label>
              <input
                id="undoShortcut"
                type="text"
                class="oz-shortcut-input"
                autocomplete="off"
                spellcheck="false"
                placeholder="Press keys…"
              />
              <button id="clearUndo" class="oz-button oz-button-ghost" type="button">Clear</button>
            </div>
          </div>

          <p id="status" class="oz-status" role="status" aria-live="polite"></p>

          <div class="oz-divider"></div>

          <div class="oz-shortcut-row">
            <div class="oz-shortcut-info">
              <div class="oz-label">Command bar</div>
              <p class="oz-help-sub">
                Open the Superhuman-style command bar (default: <kbd>Ctrl</kbd> + <kbd>K</kbd>).
              </p>
            </div>
            <div class="oz-shortcut-controls">
              <label for="commandShortcut" class="oz-visually-hidden">Command bar shortcut</label>
              <input
                id="commandShortcut"
                type="text"
                class="oz-shortcut-input"
                autocomplete="off"
                spellcheck="false"
                placeholder="Press keys…"
              />
              <button
                id="clearCommand"
                class="oz-button oz-button-ghost"
                type="button"
              >
                Clear
              </button>
            </div>
          </div>

          <p id="status-command" class="oz-status" role="status" aria-live="polite"></p>
        </div>
      </section>

      <section class="oz-card">
        <h2>Vim-style navigation</h2>
        <p class="oz-help">
          Toggle vim-style navigation to move efficiently between folders and messages using
          <kbd>h</kbd>, <kbd>j</kbd>, <kbd>k</kbd>, and <kbd>l</kbd>.
        </p>

        <label class="oz-toggle">
          <input id="vimEnabled" type="checkbox" class="oz-toggle-input" />
          <span class="oz-toggle-label">
            Enable vim-style navigation with <kbd>h</kbd>, <kbd>j</kbd>, <kbd>k</kbd>, <kbd>l</kbd>
          </span>
        </label>

        <p id="status-vim" class="oz-status" role="status" aria-live="polite"></p>

        <ul class="oz-list" style="margin-top: 0.75rem;">
          <li>
            <strong>Sidebar</strong>:
            <kbd>h</kbd> (or <kbd>l</kbd> from the message list) focuses and “pins” the sidebar.
            While pinned, <kbd>j</kbd> / <kbd>k</kbd> move up and down folders in the sidebar.
          </li>
          <li>
            <strong>Message list</strong>:
            Press <kbd>l</kbd> from the pinned sidebar to move into the message list; then
            <kbd>j</kbd> / <kbd>k</kbd> move between messages.
          </li>
          <li>
            <strong>Safe by default</strong>:
            All vim keys are ignored while you are typing in an input, textarea, or editor.
          </li>
        </ul>
      </section>

      <section class="oz-card">
        <h2>Appearance</h2>
        <p class="oz-help">
          Choose whether the options page uses a dark, glassy theme.
        </p>

        <label class="oz-toggle">
          <input id="darkModeEnabled" type="checkbox" class="oz-toggle-input" />
          <span class="oz-toggle-label">
            Enable dark mode (applies to this page and snooze/unsnooze popup)
          </span>
        </label>

        <p id="status-dark" class="oz-status" role="status" aria-live="polite"></p>
      </section>

      <section class="oz-card">
        <h2>celebration <span style="font-size: 0.75rem; font-weight: normal; opacity: 0.7;">(WIP)</span></h2>
        <p class="oz-help">
          Show a celebration animation when your inbox reaches zero messages.
        </p>

        <label class="oz-toggle">
          <input id="inboxZeroEnabled" type="checkbox" class="oz-toggle-input" />
          <span class="oz-toggle-label">
            Enable celebration overlay
          </span>
        </label>

        <p id="status-inbox-zero" class="oz-status" role="status" aria-live="polite"></p>
      </section>

      <section class="oz-card">
        <h2>AI Summaries (Optional)</h2>
        <p class="oz-help">
          Add a Google Gemini API key to enable an AI command that briefly summarizes the important
          details from the currently open email in Outlook.
        </p>

        <div class="oz-shortcut-row">
          <label for="geminiApiKey" class="oz-label">Gemini API key</label>
          <input
            id="geminiApiKey"
            type="password"
            class="oz-shortcut-input"
            autocomplete="off"
            spellcheck="false"
            placeholder="Paste your Gemini API key…"
          />
          <button id="saveGeminiKey" class="oz-button oz-button-ghost" type="button">Save</button>
          <button id="clearGeminiKey" class="oz-button oz-button-ghost" type="button">
            Clear
          </button>
        </div>

        <p id="status-gemini" class="oz-status" role="status" aria-live="polite"></p>

        <ul class="oz-list" style="margin-top: 0.75rem;">
          <li>
            <strong>When it runs</strong>: The key is only used when you invoke the
            <em>Summarize current email</em> command from the command bar.
          </li>
          <li>
            <strong>What is sent</strong>: The visible text content of the currently open email is
            sent to Google Gemini along with brief summarization instructions.
          </li>
          <li>
            <strong>Where it is stored</strong>: The API key is stored only in your browser’s
            extension storage and is not shared anywhere else.
          </li>
        </ul>
      </section>

      <section class="oz-card">
        <h2>How it works</h2>
        <ul class="oz-list">
          <li>
            <strong>Where it runs</strong>: Only on Outlook web pages
            (<code>outlook.live.com</code>, <code>outlook.office.com</code>, <code>outlook.office365.com</code>).
          </li>
          <li>
            <strong>What it does</strong>: Listens for your shortcut and clicks the
            <em>Undo</em> button that appears after you archive or move an email. When vim-style
            navigation is enabled, it also lets you move up and down the message list with
            <kbd>j</kbd> / <kbd>k</kbd>.
          </li>
          <li>
            <strong>Typing safety</strong>: Shortcuts are ignored while you are typing in an input, text area, or
            editable field so they do not interfere with composing emails.
          </li>
        </ul>
      </section>

      <section class="oz-card">
        <h2>Privacy</h2>
        <p class="oz-help">
          Zero for Outlook never collects, stores, or sends any of your email content or browsing data.
        </p>
        <ul class="oz-list">
          <li>
            <strong>No tracking</strong>: The extension does not include analytics, telemetry, or any external
            network requests.
          </li>
          <li>
            <strong>Local-only settings</strong>: Your shortcut and vim toggle are stored only using the browser’s
            extension storage and are used locally to handle key presses.
          </li>
          <li>
            <strong>Minimal permissions</strong>: It runs only on Outlook web domains and just simulates clicks for
            the Undo button and navigation elements.
          </li>
        </ul>
      </section>

      <section class="oz-card">
        <h2>About this extension</h2>
        <p class="oz-help">
          Zero for Outlook is an open-source project. You can view the source code, report issues, or
          contribute on GitHub:
          <a
            href="https://github.com/lucolvin/outlook-zero"
            target="_blank"
            rel="noopener noreferrer"
            >github.com/lucolvin/outlook-zero</a
          >.
        </p>
      </section>

      <footer class="oz-footer">
        <span>Version 0.3.0</span>
        <span>Copyright (C) 2025 Luke Colvin</span>
        <span>
          Made for Firefox &amp; Chrome · Zero for Outlook
          <a
            href="https://github.com/lucolvin/outlook-zero"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="View Zero for Outlook on GitHub"
            style="margin-left: 0.5rem;"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 16 16"
              aria-hidden="true"
              focusable="false"
            >
              <path
                fill="currentColor"
                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38
                0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52
                -.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95
                0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0
                1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15
                0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013
                8.013 0 0016 8c0-4.42-3.58-8-8-8z"
              />
            </svg>
          </a>
        </span>
      </footer>
    </main>

    <script src="options.js"></script>
  </body>
</html>

